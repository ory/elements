{"version":3,"file":"instrumenter.7f0576af.js","sources":["../../node_modules/@storybook/instrumenter/dist/esm/types.js","../../node_modules/@storybook/instrumenter/dist/esm/instrumenter.js"],"sourcesContent":["export var CallStates;\n\n(function (CallStates) {\n  CallStates[\"DONE\"] = \"done\";\n  CallStates[\"ERROR\"] = \"error\";\n  CallStates[\"ACTIVE\"] = \"active\";\n  CallStates[\"WAITING\"] = \"waiting\";\n})(CallStates || (CallStates = {}));","import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.symbol.to-primitive.js\";\nimport \"core-js/modules/es.date.to-primitive.js\";\nimport \"core-js/modules/es.number.constructor.js\";\n\nvar _global$FEATURES;\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return _typeof(key) === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (_typeof(input) !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (_typeof(res) !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.object.assign.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.values.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.string.includes.js\";\n\n/* eslint-disable no-underscore-dangle */\nimport { addons } from '@storybook/addons';\nimport { once } from '@storybook/client-logger';\nimport { FORCE_REMOUNT, IGNORED_EXCEPTION, SET_CURRENT_STORY, STORY_RENDER_PHASE_CHANGED } from '@storybook/core-events';\nimport global from 'global';\nimport { CallStates } from './types';\nexport var EVENTS = {\n  CALL: 'instrumenter/call',\n  SYNC: 'instrumenter/sync',\n  START: 'instrumenter/start',\n  BACK: 'instrumenter/back',\n  GOTO: 'instrumenter/goto',\n  NEXT: 'instrumenter/next',\n  END: 'instrumenter/end'\n};\nvar debuggerDisabled = ((_global$FEATURES = global.FEATURES) === null || _global$FEATURES === void 0 ? void 0 : _global$FEATURES.interactionsDebugger) !== true;\nvar controlsDisabled = {\n  debugger: !debuggerDisabled,\n  start: false,\n  back: false,\n  goto: false,\n  next: false,\n  end: false\n};\nvar alreadyCompletedException = new Error(\"This function ran after the play function completed. Did you forget to `await` it?\");\n\nvar isObject = function isObject(o) {\n  return Object.prototype.toString.call(o) === '[object Object]';\n};\n\nvar isModule = function isModule(o) {\n  return Object.prototype.toString.call(o) === '[object Module]';\n};\n\nvar isInstrumentable = function isInstrumentable(o) {\n  if (!isObject(o) && !isModule(o)) return false;\n  if (o.constructor === undefined) return true;\n  var proto = o.constructor.prototype;\n  if (!isObject(proto)) return false;\n  if (Object.prototype.hasOwnProperty.call(proto, 'isPrototypeOf') === false) return false;\n  return true;\n};\n\nvar construct = function construct(obj) {\n  try {\n    return new obj.constructor();\n  } catch (e) {\n    return {};\n  }\n};\n\nvar getInitialState = function getInitialState() {\n  return {\n    renderPhase: undefined,\n    isDebugging: false,\n    isPlaying: false,\n    isLocked: false,\n    cursor: 0,\n    calls: [],\n    shadowCalls: [],\n    callRefsByResult: new Map(),\n    chainedCallIds: new Set(),\n    parentId: undefined,\n    playUntil: undefined,\n    resolvers: {},\n    syncTimeout: undefined,\n    forwardedException: undefined\n  };\n};\n\nvar getRetainedState = function getRetainedState(state) {\n  var isDebugging = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var calls = (isDebugging ? state.shadowCalls : state.calls).filter(function (call) {\n    return call.retain;\n  });\n  if (!calls.length) return undefined;\n  var callRefsByResult = new Map(Array.from(state.callRefsByResult.entries()).filter(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 2),\n        ref = _ref2[1];\n\n    return ref.retain;\n  }));\n  return {\n    cursor: calls.length,\n    calls: calls,\n    callRefsByResult: callRefsByResult\n  };\n};\n/**\n * This class is not supposed to be used directly. Use the `instrument` function below instead.\n */\n\n\nexport var Instrumenter = /*#__PURE__*/function () {\n  // State is tracked per story to deal with multiple stories on the same canvas (i.e. docs mode)\n  function Instrumenter() {\n    var _this = this;\n\n    _classCallCheck(this, Instrumenter);\n\n    this.channel = void 0;\n    this.initialized = false;\n    this.state = void 0;\n    this.channel = addons.getChannel(); // Restore state from the parent window in case the iframe was reloaded.\n\n    this.state = global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ || {}; // When called from `start`, isDebugging will be true\n\n    var resetState = function resetState(_ref3) {\n      var storyId = _ref3.storyId,\n          _ref3$isPlaying = _ref3.isPlaying,\n          isPlaying = _ref3$isPlaying === void 0 ? true : _ref3$isPlaying,\n          _ref3$isDebugging = _ref3.isDebugging,\n          isDebugging = _ref3$isDebugging === void 0 ? false : _ref3$isDebugging;\n\n      var state = _this.getState(storyId);\n\n      _this.setState(storyId, Object.assign({}, getInitialState(), getRetainedState(state, isDebugging), {\n        shadowCalls: isDebugging ? state.shadowCalls : [],\n        chainedCallIds: isDebugging ? state.chainedCallIds : new Set(),\n        playUntil: isDebugging ? state.playUntil : undefined,\n        isPlaying: isPlaying,\n        isDebugging: isDebugging\n      })); // Don't sync while debugging, as it'll cause flicker.\n\n\n      if (!isDebugging) _this.sync(storyId);\n    }; // A forceRemount might be triggered for debugging (on `start`), or elsewhere in Storybook.\n\n\n    this.channel.on(FORCE_REMOUNT, resetState); // Start with a clean slate before playing after a remount, and stop debugging when done.\n\n    this.channel.on(STORY_RENDER_PHASE_CHANGED, function (_ref4) {\n      var storyId = _ref4.storyId,\n          newPhase = _ref4.newPhase;\n\n      var _this$getState = _this.getState(storyId),\n          isDebugging = _this$getState.isDebugging,\n          forwardedException = _this$getState.forwardedException;\n\n      _this.setState(storyId, {\n        renderPhase: newPhase\n      });\n\n      if (newPhase === 'playing') {\n        resetState({\n          storyId: storyId,\n          isDebugging: isDebugging\n        });\n      }\n\n      if (newPhase === 'played') {\n        _this.setState(storyId, {\n          isLocked: false,\n          isPlaying: false,\n          isDebugging: false,\n          forwardedException: undefined\n        }); // Rethrow any unhandled forwarded exception so it doesn't go unnoticed.\n\n\n        if (forwardedException) throw forwardedException;\n      }\n    }); // Trash non-retained state and clear the log when switching stories, but not on initial boot.\n\n    this.channel.on(SET_CURRENT_STORY, function () {\n      if (_this.initialized) _this.cleanup();else _this.initialized = true;\n    });\n\n    var start = function start(_ref5) {\n      var storyId = _ref5.storyId,\n          playUntil = _ref5.playUntil;\n\n      if (!_this.getState(storyId).isDebugging) {\n        _this.setState(storyId, function (_ref6) {\n          var calls = _ref6.calls;\n          return {\n            calls: [],\n            shadowCalls: calls.map(function (call) {\n              return Object.assign({}, call, {\n                status: CallStates.WAITING\n              });\n            }),\n            isDebugging: true\n          };\n        });\n      }\n\n      var log = _this.getLog(storyId);\n\n      _this.setState(storyId, function (_ref7) {\n        var _shadowCalls$slice$fi;\n\n        var shadowCalls = _ref7.shadowCalls;\n        var firstRowIndex = shadowCalls.findIndex(function (call) {\n          return call.id === log[0].callId;\n        });\n        return {\n          playUntil: playUntil || ((_shadowCalls$slice$fi = shadowCalls.slice(0, firstRowIndex).filter(function (call) {\n            return call.interceptable;\n          }).slice(-1)[0]) === null || _shadowCalls$slice$fi === void 0 ? void 0 : _shadowCalls$slice$fi.id)\n        };\n      }); // Force remount may trigger a page reload if the play function can't be aborted.\n\n\n      _this.channel.emit(FORCE_REMOUNT, {\n        storyId: storyId,\n        isDebugging: true\n      });\n    };\n\n    var back = function back(_ref8) {\n      var _log;\n\n      var storyId = _ref8.storyId;\n\n      var _this$getState2 = _this.getState(storyId),\n          isDebugging = _this$getState2.isDebugging;\n\n      var log = _this.getLog(storyId);\n\n      var next = isDebugging ? log.findIndex(function (_ref9) {\n        var status = _ref9.status;\n        return status === CallStates.WAITING;\n      }) : log.length;\n      start({\n        storyId: storyId,\n        playUntil: (_log = log[next - 2]) === null || _log === void 0 ? void 0 : _log.callId\n      });\n    };\n\n    var goto = function goto(_ref10) {\n      var storyId = _ref10.storyId,\n          callId = _ref10.callId;\n\n      var _this$getState3 = _this.getState(storyId),\n          calls = _this$getState3.calls,\n          shadowCalls = _this$getState3.shadowCalls,\n          resolvers = _this$getState3.resolvers;\n\n      var call = calls.find(function (_ref11) {\n        var id = _ref11.id;\n        return id === callId;\n      });\n      var shadowCall = shadowCalls.find(function (_ref12) {\n        var id = _ref12.id;\n        return id === callId;\n      });\n\n      if (!call && shadowCall && Object.values(resolvers).length > 0) {\n        var _this$getLog$find;\n\n        var nextId = (_this$getLog$find = _this.getLog(storyId).find(function (c) {\n          return c.status === CallStates.WAITING;\n        })) === null || _this$getLog$find === void 0 ? void 0 : _this$getLog$find.callId;\n        if (shadowCall.id !== nextId) _this.setState(storyId, {\n          playUntil: shadowCall.id\n        });\n        Object.values(resolvers).forEach(function (resolve) {\n          return resolve();\n        });\n      } else {\n        start({\n          storyId: storyId,\n          playUntil: callId\n        });\n      }\n    };\n\n    var next = function next(_ref13) {\n      var storyId = _ref13.storyId;\n\n      var _this$getState4 = _this.getState(storyId),\n          resolvers = _this$getState4.resolvers;\n\n      if (Object.values(resolvers).length > 0) {\n        Object.values(resolvers).forEach(function (resolve) {\n          return resolve();\n        });\n      } else {\n        var _this$getLog$find2;\n\n        var nextId = (_this$getLog$find2 = _this.getLog(storyId).find(function (c) {\n          return c.status === CallStates.WAITING;\n        })) === null || _this$getLog$find2 === void 0 ? void 0 : _this$getLog$find2.callId;\n        if (nextId) start({\n          storyId: storyId,\n          playUntil: nextId\n        });else end({\n          storyId: storyId\n        });\n      }\n    };\n\n    var end = function end(_ref14) {\n      var storyId = _ref14.storyId;\n\n      _this.setState(storyId, {\n        playUntil: undefined,\n        isDebugging: false\n      });\n\n      Object.values(_this.getState(storyId).resolvers).forEach(function (resolve) {\n        return resolve();\n      });\n    };\n\n    this.channel.on(EVENTS.START, start);\n    this.channel.on(EVENTS.BACK, back);\n    this.channel.on(EVENTS.GOTO, goto);\n    this.channel.on(EVENTS.NEXT, next);\n    this.channel.on(EVENTS.END, end);\n  }\n\n  _createClass(Instrumenter, [{\n    key: \"getState\",\n    value: function getState(storyId) {\n      return this.state[storyId] || getInitialState();\n    }\n  }, {\n    key: \"setState\",\n    value: function setState(storyId, update) {\n      var state = this.getState(storyId);\n      var patch = typeof update === 'function' ? update(state) : update;\n      this.state = Object.assign({}, this.state, _defineProperty({}, storyId, Object.assign({}, state, patch))); // Track state on the parent window so we can reload the iframe without losing state.\n\n      global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ = this.state;\n    }\n  }, {\n    key: \"cleanup\",\n    value: function cleanup() {\n      // Reset stories with retained state to their initial state, and drop the rest.\n      this.state = Object.entries(this.state).reduce(function (acc, _ref15) {\n        var _ref16 = _slicedToArray(_ref15, 2),\n            storyId = _ref16[0],\n            state = _ref16[1];\n\n        var retainedState = getRetainedState(state);\n        if (!retainedState) return acc;\n        acc[storyId] = Object.assign(getInitialState(), retainedState);\n        return acc;\n      }, {});\n      this.channel.emit(EVENTS.SYNC, {\n        controlStates: controlsDisabled,\n        logItems: []\n      });\n      global.window.parent.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER_STATE__ = this.state;\n    }\n  }, {\n    key: \"getLog\",\n    value: function getLog(storyId) {\n      var _this$getState5 = this.getState(storyId),\n          calls = _this$getState5.calls,\n          shadowCalls = _this$getState5.shadowCalls;\n\n      var merged = _toConsumableArray(shadowCalls);\n\n      calls.forEach(function (call, index) {\n        merged[index] = call;\n      });\n      var seen = new Set();\n      return merged.reduceRight(function (acc, call) {\n        call.args.forEach(function (arg) {\n          if (arg !== null && arg !== void 0 && arg.__callId__) {\n            seen.add(arg.__callId__);\n          }\n        });\n        call.path.forEach(function (node) {\n          if (node.__callId__) {\n            seen.add(node.__callId__);\n          }\n        });\n\n        if (call.interceptable && !seen.has(call.id)) {\n          acc.unshift({\n            callId: call.id,\n            status: call.status\n          });\n          seen.add(call.id);\n        }\n\n        return acc;\n      }, []);\n    } // Traverses the object structure to recursively patch all function properties.\n    // Returns the original object, or a new object with the same constructor,\n    // depending on whether it should mutate.\n\n  }, {\n    key: \"instrument\",\n    value: function instrument(obj, options) {\n      var _this2 = this;\n\n      if (!isInstrumentable(obj)) return obj;\n      var _options$mutate = options.mutate,\n          mutate = _options$mutate === void 0 ? false : _options$mutate,\n          _options$path = options.path,\n          path = _options$path === void 0 ? [] : _options$path;\n      return Object.keys(obj).reduce(function (acc, key) {\n        var value = obj[key]; // Nothing to patch, but might be instrumentable, so we recurse\n\n        if (typeof value !== 'function') {\n          acc[key] = _this2.instrument(value, Object.assign({}, options, {\n            path: path.concat(key)\n          }));\n          return acc;\n        } // Already patched, so we pass through unchanged\n\n\n        if (typeof value.__originalFn__ === 'function') {\n          acc[key] = value;\n          return acc;\n        } // Patch the function and mark it \"patched\" by adding a reference to the original function\n\n\n        acc[key] = function () {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return _this2.track(key, value, args, options);\n        };\n\n        acc[key].__originalFn__ = value; // Reuse the original name as the patched function's name\n\n        Object.defineProperty(acc[key], 'name', {\n          value: key,\n          writable: false\n        }); // Deal with functions that also act like an object\n\n        if (Object.keys(value).length > 0) {\n          Object.assign(acc[key], _this2.instrument(Object.assign({}, value), Object.assign({}, options, {\n            path: path.concat(key)\n          })));\n        }\n\n        return acc;\n      }, mutate ? obj : construct(obj));\n    } // Monkey patch an object method to record calls.\n    // Returns a function that invokes the original function, records the invocation (\"call\") and\n    // returns the original result.\n\n  }, {\n    key: \"track\",\n    value: function track(method, fn, args, options) {\n      var _args$, _global$window$__STOR, _global$window$__STOR2, _global$window$__STOR3;\n\n      var storyId = (args === null || args === void 0 ? void 0 : (_args$ = args[0]) === null || _args$ === void 0 ? void 0 : _args$.__storyId__) || ((_global$window$__STOR = global.window.__STORYBOOK_PREVIEW__) === null || _global$window$__STOR === void 0 ? void 0 : (_global$window$__STOR2 = _global$window$__STOR.urlStore) === null || _global$window$__STOR2 === void 0 ? void 0 : (_global$window$__STOR3 = _global$window$__STOR2.selection) === null || _global$window$__STOR3 === void 0 ? void 0 : _global$window$__STOR3.storyId);\n\n      var _this$getState6 = this.getState(storyId),\n          cursor = _this$getState6.cursor,\n          parentId = _this$getState6.parentId;\n\n      this.setState(storyId, {\n        cursor: cursor + 1\n      });\n      var id = \"\".concat(parentId || storyId, \" [\").concat(cursor, \"] \").concat(method);\n      var _options$path2 = options.path,\n          path = _options$path2 === void 0 ? [] : _options$path2,\n          _options$intercept = options.intercept,\n          intercept = _options$intercept === void 0 ? false : _options$intercept,\n          _options$retain = options.retain,\n          retain = _options$retain === void 0 ? false : _options$retain;\n      var interceptable = typeof intercept === 'function' ? intercept(method, path) : intercept;\n      var call = {\n        id: id,\n        parentId: parentId,\n        storyId: storyId,\n        cursor: cursor,\n        path: path,\n        method: method,\n        args: args,\n        interceptable: interceptable,\n        retain: retain\n      };\n      var result = (interceptable ? this.intercept : this.invoke).call(this, fn, call, options);\n      return this.instrument(result, Object.assign({}, options, {\n        mutate: true,\n        path: [{\n          __callId__: call.id\n        }]\n      }));\n    }\n  }, {\n    key: \"intercept\",\n    value: function intercept(fn, call, options) {\n      var _this3 = this;\n\n      var _this$getState7 = this.getState(call.storyId),\n          chainedCallIds = _this$getState7.chainedCallIds,\n          isDebugging = _this$getState7.isDebugging,\n          playUntil = _this$getState7.playUntil; // For a \"jump to step\" action, continue playing until we hit a call by that ID.\n      // For chained calls, we can only return a Promise for the last call in the chain.\n\n\n      var isChainedUpon = chainedCallIds.has(call.id);\n\n      if (!isDebugging || isChainedUpon || playUntil) {\n        if (playUntil === call.id) {\n          this.setState(call.storyId, {\n            playUntil: undefined\n          });\n        }\n\n        return this.invoke(fn, call, options);\n      } // Instead of invoking the function, defer the function call until we continue playing.\n\n\n      return new Promise(function (resolve) {\n        _this3.setState(call.storyId, function (_ref17) {\n          var resolvers = _ref17.resolvers;\n          return {\n            isLocked: false,\n            resolvers: Object.assign({}, resolvers, _defineProperty({}, call.id, resolve))\n          };\n        });\n      }).then(function () {\n        _this3.setState(call.storyId, function (state) {\n          var _state$resolvers = state.resolvers,\n              _call$id = call.id,\n              _ = _state$resolvers[_call$id],\n              resolvers = _objectWithoutProperties(_state$resolvers, [_call$id].map(_toPropertyKey));\n\n          return {\n            isLocked: true,\n            resolvers: resolvers\n          };\n        });\n\n        return _this3.invoke(fn, call, options);\n      });\n    }\n  }, {\n    key: \"invoke\",\n    value: function invoke(fn, call, options) {\n      var _this4 = this;\n\n      // TODO this doesnt work because the abortSignal we have here is the newly created one\n      // const { abortSignal } = global.window.__STORYBOOK_PREVIEW__ || {};\n      // if (abortSignal && abortSignal.aborted) throw IGNORED_EXCEPTION;\n      var _this$getState8 = this.getState(call.storyId),\n          callRefsByResult = _this$getState8.callRefsByResult,\n          forwardedException = _this$getState8.forwardedException,\n          renderPhase = _this$getState8.renderPhase;\n\n      var info = Object.assign({}, call, {\n        // Map args that originate from a tracked function call to a call reference to enable nesting.\n        // These values are often not fully serializable anyway (e.g. HTML elements).\n        args: call.args.map(function (arg) {\n          if (callRefsByResult.has(arg)) {\n            return callRefsByResult.get(arg);\n          }\n\n          if (arg instanceof global.window.HTMLElement) {\n            var prefix = arg.prefix,\n                localName = arg.localName,\n                id = arg.id,\n                classList = arg.classList,\n                innerText = arg.innerText;\n            var classNames = Array.from(classList);\n            return {\n              __element__: {\n                prefix: prefix,\n                localName: localName,\n                id: id,\n                classNames: classNames,\n                innerText: innerText\n              }\n            };\n          }\n\n          return arg;\n        })\n      }); // Mark any ancestor calls as \"chained upon\" so we won't attempt to defer it later.\n\n      call.path.forEach(function (ref) {\n        if (ref !== null && ref !== void 0 && ref.__callId__) {\n          _this4.setState(call.storyId, function (_ref18) {\n            var chainedCallIds = _ref18.chainedCallIds;\n            return {\n              chainedCallIds: new Set(Array.from(chainedCallIds).concat(ref.__callId__))\n            };\n          });\n        }\n      });\n\n      var handleException = function handleException(e) {\n        if (e instanceof Error) {\n          var name = e.name,\n              message = e.message,\n              stack = e.stack;\n          var exception = {\n            name: name,\n            message: message,\n            stack: stack\n          };\n\n          _this4.update(Object.assign({}, info, {\n            status: CallStates.ERROR,\n            exception: exception\n          })); // Always track errors to their originating call.\n\n\n          _this4.setState(call.storyId, function (state) {\n            return {\n              callRefsByResult: new Map([].concat(_toConsumableArray(Array.from(state.callRefsByResult.entries())), [[e, {\n                __callId__: call.id,\n                retain: call.retain\n              }]]))\n            };\n          }); // We need to throw to break out of the play function, but we don't want to trigger a redbox\n          // so we throw an ignoredException, which is caught and silently ignored by Storybook.\n\n\n          if (call.interceptable && e !== alreadyCompletedException) {\n            throw IGNORED_EXCEPTION;\n          } // Non-interceptable calls need their exceptions forwarded to the next interceptable call.\n          // In case no interceptable call picks it up, it'll get rethrown in the \"completed\" phase.\n\n\n          _this4.setState(call.storyId, {\n            forwardedException: e\n          });\n\n          return e;\n        }\n\n        throw e;\n      };\n\n      try {\n        // An earlier, non-interceptable call might have forwarded an exception.\n        if (forwardedException) {\n          this.setState(call.storyId, {\n            forwardedException: undefined\n          });\n          throw forwardedException;\n        }\n\n        if (renderPhase === 'played' && !call.retain) {\n          throw alreadyCompletedException;\n        }\n\n        var finalArgs = options.getArgs ? options.getArgs(call, this.getState(call.storyId)) : call.args;\n        var result = fn.apply(void 0, _toConsumableArray(finalArgs.map(function (arg) {\n          if (typeof arg !== 'function' || Object.keys(arg).length) return arg;\n          return function () {\n            var _this4$getState = _this4.getState(call.storyId),\n                cursor = _this4$getState.cursor,\n                parentId = _this4$getState.parentId;\n\n            _this4.setState(call.storyId, {\n              cursor: 0,\n              parentId: call.id\n            });\n\n            var restore = function restore() {\n              return _this4.setState(call.storyId, {\n                cursor: cursor,\n                parentId: parentId\n              });\n            };\n\n            var res = arg.apply(void 0, arguments);\n            if (res instanceof Promise) res.then(restore, restore);else restore();\n            return res;\n          };\n        }))); // Track the result so we can trace later uses of it back to the originating call.\n        // Primitive results (undefined, null, boolean, string, number, BigInt) are ignored.\n\n        if (result && ['object', 'function', 'symbol'].includes(_typeof(result))) {\n          this.setState(call.storyId, function (state) {\n            return {\n              callRefsByResult: new Map([].concat(_toConsumableArray(Array.from(state.callRefsByResult.entries())), [[result, {\n                __callId__: call.id,\n                retain: call.retain\n              }]]))\n            };\n          });\n        }\n\n        this.update(Object.assign({}, info, {\n          status: result instanceof Promise ? CallStates.ACTIVE : CallStates.DONE\n        }));\n\n        if (result instanceof Promise) {\n          return result.then(function (value) {\n            _this4.update(Object.assign({}, info, {\n              status: CallStates.DONE\n            }));\n\n            return value;\n          }, handleException);\n        }\n\n        return result;\n      } catch (e) {\n        return handleException(e);\n      }\n    } // Sends the call info and log to the manager.\n    // Uses a 0ms debounce because this might get called many times in one tick.\n\n  }, {\n    key: \"update\",\n    value: function update(call) {\n      var _this5 = this;\n\n      clearTimeout(this.getState(call.storyId).syncTimeout);\n      this.channel.emit(EVENTS.CALL, call);\n      this.setState(call.storyId, function (_ref19) {\n        var calls = _ref19.calls;\n        // Omit earlier calls for the same ID, which may have been superceded by a later invocation.\n        // This typically happens when calls are part of a callback which runs multiple times.\n        var callsById = calls.concat(call).reduce(function (a, c) {\n          return Object.assign(a, _defineProperty({}, c.id, c));\n        }, {});\n        return {\n          // Calls are sorted to ensure parent calls always come before calls in their callback.\n          calls: Object.values(callsById).sort(function (a, b) {\n            return a.id.localeCompare(b.id, undefined, {\n              numeric: true\n            });\n          }),\n          syncTimeout: setTimeout(function () {\n            return _this5.sync(call.storyId);\n          }, 0)\n        };\n      });\n    }\n  }, {\n    key: \"sync\",\n    value: function sync(storyId) {\n      var _this$getState9 = this.getState(storyId),\n          isLocked = _this$getState9.isLocked,\n          isPlaying = _this$getState9.isPlaying;\n\n      var logItems = this.getLog(storyId);\n      var hasActive = logItems.some(function (item) {\n        return item.status === CallStates.ACTIVE;\n      });\n\n      if (debuggerDisabled || isLocked || hasActive || logItems.length === 0) {\n        this.channel.emit(EVENTS.SYNC, {\n          controlStates: controlsDisabled,\n          logItems: logItems\n        });\n        return;\n      }\n\n      var hasPrevious = logItems.some(function (item) {\n        return [CallStates.DONE, CallStates.ERROR].includes(item.status);\n      });\n      var controlStates = {\n        debugger: true,\n        start: hasPrevious,\n        back: hasPrevious,\n        goto: true,\n        next: isPlaying,\n        end: isPlaying\n      };\n      this.channel.emit(EVENTS.SYNC, {\n        controlStates: controlStates,\n        logItems: logItems\n      });\n    }\n  }]);\n\n  return Instrumenter;\n}();\n/**\n * Instruments an object or module by traversing its properties, patching any functions (methods)\n * to enable debugging. Patched functions will emit a `call` event when invoked.\n * When intercept = true, patched functions will return a Promise when the debugger stops before\n * this function. As such, \"interceptable\" functions will have to be `await`-ed.\n */\n\nexport function instrument(obj) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  try {\n    // Don't do any instrumentation if not loaded in an iframe.\n    if (global.window.parent === global.window) return obj; // Only create an instance if we don't have one (singleton) yet.\n\n    if (!global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__) {\n      global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__ = new Instrumenter();\n    }\n\n    var instrumenter = global.window.__STORYBOOK_ADDON_INTERACTIONS_INSTRUMENTER__;\n    return instrumenter.instrument(obj, options);\n  } catch (e) {\n    // Access to the parent window might fail due to CORS restrictions.\n    once.warn(e);\n    return obj;\n  }\n}"],"names":["global"],"mappings":"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"}